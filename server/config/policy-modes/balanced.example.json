{
  "schemaVersion": 1,
  "mode": "balanced",
  "description": "Safer default for most users: ask on high-impact actions, allow low-risk local reads.",
  "fallback": "ask",
  "guardrails": [
    {
      "id": "block-secret-files",
      "decision": "block",
      "risk": "critical",
      "label": "Block secret credential files",
      "reason": "Never allow direct reads of private key material",
      "match": {
        "tool": "read",
        "pathMatches": "*identity_ed25519*"
      }
    },
    {
      "id": "block-host-root-rm",
      "decision": "block",
      "risk": "critical",
      "label": "Block destructive root delete",
      "reason": "Prevents catastrophic filesystem deletion",
      "match": {
        "tool": "bash",
        "executable": "rm",
        "commandMatches": "rm -rf /*"
      }
    }
  ],
  "permissions": [
    {
      "id": "ask-ios-build-install",
      "decision": "ask",
      "risk": "high",
      "label": "Install app on iPhone",
      "reason": "Physical device install should always require explicit approval",
      "match": {
        "tool": "bash",
        "commandMatches": "*scripts/build-install.sh*"
      }
    },
    {
      "id": "ask-devicectl-install",
      "decision": "ask",
      "risk": "high",
      "label": "Install app with devicectl",
      "match": {
        "tool": "bash",
        "executable": "xcrun",
        "commandMatches": "xcrun devicectl device install app*"
      }
    },
    {
      "id": "ask-server-restart",
      "decision": "ask",
      "risk": "high",
      "label": "Start/restart Oppi server",
      "match": {
        "tool": "bash",
        "commandMatches": "*tsx src/cli.ts serve*"
      }
    },
    {
      "id": "allow-safe-read-workspace",
      "decision": "allow",
      "risk": "low",
      "label": "Allow read-only workspace inspection",
      "match": {
        "tool": "read",
        "pathWithin": "/Users/example/workspace/oppi"
      }
    },
    {
      "id": "ask-git-push",
      "decision": "ask",
      "risk": "high",
      "label": "Push code to remote",
      "match": {
        "tool": "bash",
        "executable": "git",
        "commandMatches": "git push*"
      }
    }
  ]
}
